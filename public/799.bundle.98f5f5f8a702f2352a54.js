"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[799],{91799:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(32735),a=n(60216),s=n.n(a),i=n(62771),l=n(28619),o=n(21572),c=n(57270),u=n(43418),m=n(77331);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}const{formatDate:p}=i.utils;function f(e){const{displaySets:t,viewportIndex:n,viewportLabel:a,servicesManager:s,extensionManager:f,viewportOptions:E}=e,{t:g}=(0,o.$G)("TrackedViewport"),{measurementService:v,cornerstoneViewportService:b}=s.services,w=t[0],[S]=(0,u.I)(),[h,x]=(0,r.useState)(!1),[y,I]=(0,r.useState)(null),[N,k]=(0,r.useState)(null),{trackedSeries:V}=S.context,D=E.viewportId,{SeriesDate:O,SeriesDescription:M,SeriesInstanceUID:T,SeriesNumber:P}=w,{PatientID:C,PatientName:R,PatientSex:U,PatientAge:_,SliceThickness:j,SpacingBetweenSlices:A,ManufacturerModelName:F}=w.images[0],L=(0,r.useCallback)((()=>{const e=b.getCornerstoneViewportByIndex(n);if(e instanceof m.BaseVolumeViewport){const t=e?.getCurrentImageId();if(!t)return void(h&&x(!1))}V.includes(T)!==h&&x(!h)}),[h,S,n,T]),W=(0,r.useCallback)((e=>{e.detail.element!==N&&(e.detail.element?.addEventListener(m.Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME,L),k(e.detail.element))}),[L,N]),q=(0,r.useCallback)((()=>{N?.removeEventListener(m.Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME,L)}),[L,N]);(0,r.useEffect)(L,[L]),(0,r.useEffect)((()=>{const{unsubscribe:e}=b.subscribe(b.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportIndex===n&&L()}));return()=>{e()}}),[L,n]),(0,r.useEffect)((()=>h?(c.annotation.config.style.setViewportToolStyles(D,{global:{lineDash:""}}),void b.getRenderingEngine().renderViewport(D)):(c.annotation.config.style.setViewportToolStyles(D,{global:{lineDash:"4,4"}}),b.getRenderingEngine().renderViewport(D),()=>{c.annotation.config.style.setViewportToolStyles(D,{})})),[h]);return r.createElement(r.Fragment,null,r.createElement(l.uY,{onDoubleClick:e=>{e.stopPropagation(),e.preventDefault()},useAltStyling:h,onArrowsClick:e=>function(e){const t=function(e,t,n,r){const{measurementService:a,viewportGridService:s}=t.services,i=a.getMeasurements(),{activeViewportIndex:l,viewports:o}=s.getState(),{displaySetInstanceUIDs:c}=o[l],{trackedSeries:u}=r.context,m=i.filter((e=>u.includes(e.referenceSeriesUID)&&c.includes(e.displaySetInstanceUID)));if(!m.length)return;const d=m.length,p=m.map((e=>e.uid));let f=p.findIndex((e=>e===n));return-1===f?f=0:"left"===e?(f--,f<0&&(f=d-1)):"right"===e&&(f++,f===d&&(f=0)),p[f]}(e,s,y,S);t&&(I(t),v.jumpToMeasurement(n,t))}(e),getStatusComponent:()=>function(e){const t=e?"status-tracked":"status-untracked";return r.createElement("div",{className:"relative"},r.createElement(l.u,{position:"bottom-left",content:r.createElement("div",{className:"flex py-2"},r.createElement("div",{className:"flex pt-1"},r.createElement(l.JO,{name:"info-link",className:"w-4 text-primary-main"})),r.createElement("div",{className:"flex ml-4"},r.createElement("span",{className:"text-base text-common-light"},e?r.createElement(r.Fragment,null,"Series is",r.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",r.createElement("br",null)," in the measurement panel"):r.createElement(r.Fragment,null,"Measurements for",r.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",r.createElement("br",null)," will not be shown in the ",r.createElement("br",null)," measurements panel"))))},r.createElement(l.JO,{name:t,className:"text-primary-light"})))}(h),studyData:{label:a,studyDate:p(O),currentSeries:P,seriesDescription:M,patientInformation:{patientName:R?i.default.utils.formatPN(R):"",patientSex:U||"",patientAge:_||"",MRN:C||"",thickness:j?`${parseFloat(j).toFixed(2)}mm`:"",spacing:void 0!==A?`${parseFloat(A).toFixed(2)}mm`:"",scanner:F||""}}}),r.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(()=>{const{component:t}=f.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone");return r.createElement(t,d({},e,{onElementEnabled:W,onElementDisabled:q}))})()))}f.propTypes={displaySets:s().arrayOf(s().object.isRequired).isRequired,viewportIndex:s().number.isRequired,dataSource:s().object,children:s().node,customProps:s().object},f.defaultProps={customProps:{}};const E=f}}]);
//# sourceMappingURL=799.bundle.98f5f5f8a702f2352a54.js.map